!function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t():e._=t()}(this,function(){"use strict";function e(e,t,n){for(var i=0,r=e.length;i<r;i++)t.apply(n||e,[e[i],i,e]);return e}function t(t,n,i){var r=d.keys(t);return e(r,function(e,r){n.call(i||t,t[e],e,t)},i||t),t}function n(e){return decodeURIComponent(e.replace(/\+/g," "))}function i(e){return encodeURIComponent(e).replace(" ","%20")}function r(e){return g[e]||e}function o(e){return m[e]||e}function a(e){return"\\"+L[e]}var c="0.1",s=Object.prototype,u=(Array.prototype,Number.prototype,String.prototype,[]),l=u.slice,f=u.splice,h=function(){return this||(0,eval)("this")}(),d={};d.extend=function(e){var t=l.call(arguments);if(t.length>1)d.compose(e,t[1]);else for(var n in e)e.hasOwnProperty(n)&&(d[n]=e[n]);return e},d.define=function(e,t,n){return d.isObject(t)?Object.defineProperties(e,t):Object.defineProperty(e,t,n)},d.isObject=function(e){return"function"==typeof e||"object"==typeof e&&!!e};var p=["Array","Arguments","Boolean","Function","String","Number","Null","Date","RegExp","NodeList","Undefined","HTMLCollection"];p.forEach(function(e,t){d["is"+e]=function(t){return s.toString.call(t)==="[object "+e+"]"}}),d.extend({NULL:function(){},cool:function(e){return e},root:h,broken:{},version:c,foreach:function(n,i,r){if(null!=n){if(d.isArray(n))return e(n,i,r);if(d.isObject(n)&&!d.isFunction(n))return t(n,i,r)}return n},keys:Object.keys,slice:function(e){return null!=e?l.call(e):[]},splice:function(e,t,n){return d.isArray(e)?f.call(e,t,n||1):delete e[t],e},clone:function(e){return d.isArray(e)?l.call(e):d.isObject(e)&&!d.isFunction(e)?JSON.parse(JSON.stringify(e)):e},clonedoom:function(e){if(d.isArray(e)||d.isArguments(e)||d.isNodeList(e)||d.isHTMLCollection(e))return l.call(e);if(d.isObject(e)&&!d.isFunction(e)){var t=function(){};t.prototype=e.constructor.prototype;var n=new t;return d.foreach(e,function(e,t){d.isString(e)||d.isNumber(e)?n[t]=e:n[t]=d.clonedoom(e)}),n}return e},sort:function(e,t){return d.isArray(e)?e.sort(t):e},unique:function(e){for(var t=e.length,n=0;n<t&&n!==e.length-1;n++)for(var i=n+1;i<e.length;i++)e[n]===e[i]&&e.splice(i--,1);return e},reject:function(e,t){var n=[];return d.foreach(d.clonedoom(e),function(e,i,r){t.call(r,e,i,r)||n.push(e)}),n},filter:function(e,t){var n=[];return d.foreach(d.clonedoom(e),function(e,i,r){t.call(r,e,i,r)&&n.push(e)}),n},map:function(e,t){return e.map(t)},find:function(e,t){return d.filter(e,t)},cat:function(e,t){var n=[];if(d.isArray(e))for(var i=e.length;i--;)t.call(e,e[i],i,e)&&n.push(e.splice(i,1)[0]);else if(d.isObject(e))for(var i in e)t.call(e,e[i],i,e)&&(n.push(e[i]),delete e[i]);return n},findindex:function(e,t){var n=[];return d.foreach(e,function(e,i,r){t.call(r,e,i,r)&&n.push(i)}),n},contain:function(e,t){return!!d.find(e,function(e){return e===t}).length},hook:function(e,t){var n=l.call(arguments,2),i=d.isFunction(t);return d.map(e,function(e){return(i?t:e[t]).apply(e,n)})},fnbind:function(e){Function.bind.apply(e,l.call(arguments,1))},bind:function(e){var t=l.call(arguments,1);return d.foreach(t,function(t,n){e[n]=d.fnbind(e[n],e)}),e},reverse:function(e){return d.isArray(e)?d.slice(e).reverse():e},pluck:function(e,t){var n=[];return d.foreach(e,function(e){for(var i=d.keys(e),r=i.length;r--;)i[r]===t+""&&n.push(e[i[r]])}),n},groupby:function(e,t){if(d.isArray(e)){var n={},i=d.isFunction(t);return d.foreach(e,function(e){var r=i?t(e):e[t];n[r]?n.hasOwnProperty(r)&&n[r].push(e):n[r]=[e]}),n}return e},toarray:function(e){for(var t=d.keys(e),n=t.length,i=Array(n),r=0;r<n;r++)i[r]=e[t[r]];return i},forarray:function(e){for(var t=d.keys(e),n=t.length,i=Array(n),r=0;r<n;r++){var o={};o[t[r]]=e[t[r]],i[r]=o}return i},pairs:function(e){for(var t=[],n=d.keys(e),i=0,r=n.length;i<r;i++)result.push([n[i],e[n[i]]]);return t},random:function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},compose:function(e,t){return d.foreach(t,function(t,n){e[n]=t}),e},has:function(e,t){var n=0;return d.foreach(e,function(e){e===t&&(n=1)}),!!n},not:function(e,t){for(var n=0,i=e.length;n<i;n++)d.isequal(e[n],t)&&d.splice(e,n--);return e},bale:function(e,t){return d.isArray(e)&&d.isArray(t)?ba.contact(t):d.compose(d.clonedoom(e),d.clonedoom(t))},shuffle:function(e){for(var t,n=d.isArray(e)?e:d.toarray(e),i=n.length,r=Array(i),o=0;o<i;o++)t=d.random(0,o),t!==o&&(r[o]=r[t]),r[t]=n[o];return r},trim:function(e){return e.replace(/^\s+|\s+$/gm,"")},merge:function(){var e=[],t=l.call(arguments);return t.forEach(function(t){e=e.concat(t)}),d.unique(e)},partial:function(e){var t=slice.call(arguments,1);return function(){for(var n=0,i=t.slice(),r=0,o=i.length;r<o;r++)i[r]===d&&(i[r]=arguments[n++]);for(;n<arguments.length;)i.push(arguments[n++]);return e.apply(this,i)}},before:function(e,t){var n;return function(){return--e>0?n=t.apply(this,arguments):t=null,n}},hack:function(e,t){var n=d.partial(d.before,(parseInt(t)||1)+1);return n(e)},once:function(e){return d.hack(e,1)},tostring:function(e){return s.toString.call(e)},isequal:function(e,t){if(e===t)return!0;if(d.tostring(e)===d.tostring(t)){if(d.isArray(e)){if(e.length===t.length){for(var n=e.length;n--;)if(e[n]!==t[n])return!1;return!0}return!1}if(d.isObject(e)){var i=d.keys(e),r=d.keys(t);if(i.length===r.length){for(var n=i.length;n--;)if(e[i[n]]!==t[i[n]])return!1;return!0}return!1}if(d.isString(e)||d.isNumber(e))return e.toString()===t.toString()}return!1},typeof:function(e){var t,n=[d.isArray(e),d.isArguments(e),d.isBoolean(e),d.isFunction(e),d.isString(e),d.isNumber(e),d.isNull(e),d.isDate(e),d.isRegExp(e),d.isNodeList(e),d.isUndefined(e),d.isHTMLCollection(e)];return t=d.findindex(n,function(e){return e===!0}).shift(),null==t?"object":p[t].toLowerCase()},requery:function(e){var t={};return d.foreach(e,function(e){t[e.name]=e.value}),t},async:function(e,t){return setTimeout(e,t||0)}});var v=/[\t\r\n\f\x20]/g;d.extend({paramparse:function(e){var t,i,r=e.indexOf("?"),o=/([^&=]+)=?([^&]*)/g,a={};for(t=r===-1?e:e.substr(r+1);i=o.exec(t);)a[n(i[1])]=n(i[2]);return a},paramstringify:function(e){var t=d.clone(e);for(var n in t)t[n]=i(d.isObject(t[n])||d.isArray(t[n])?JSON.stringify(t[n]):t[n]);var r=JSON.stringify(t);return r.replace(/[\"\{\}]/g,"").replace(/:/g,"=").replace(/,/g,"&").replace(v,"")},parseString:function(e){return d.isBoolean(e)?e:e+""}});var g={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"$quot;","'":"&#x27;","`":"&#x60"},m={"&amp;":"&","&gt;":">","&lt;":"<","&quot;":'"',"&#x27;":"'","&#x60;":"`"},b="(.)^",y=/\\|'|\r|\n|\u2028|\u2029/g,L={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},w=d.doomSetting={escape:"{{-([\\s\\S]+?)}}",interpolate:"{{#([\\s\\S]+?)}}",evaluate:"{{([\\s\\S]+?)}}"};if(d.extend({encodeHTML:function(e){return+e===e?e:e.replace(/[&<">'](?:(amp|lt|quot|gt|#39);)?/g,r)},decodeHTML:function(e){return+e===e?e:e.replace(/&((g|l|quo)t|amp|#39);/g,o)},doom:function(e,t){var n=0,i="_p+='",r=RegExp((w.escape||b)+"|"+(w.interpolate||b)+"|"+(w.evaluate||b)+"|$","g");e.replace(r,function(t,r,o,c,s){return i+=e.slice(n,s).replace(y,a),n=s+t.length,r?i+="'+\n((_t=("+r+"))==null?'':_.encodeHTML(_t))+\n'":o?i+="'+\n((_t=("+o+"))==null?'':_t)+\n'":c&&(i+="';\n"+c+"\n_p+='"),t}),i+="';\n",t||(i="with(_x||{}){\n"+i+"}\n"),i="var _t,_p='',_j=Array.prototype.join,print=function(){_p+=_j.call(arguments,'');};\n"+i+"return _p;\n";try{var o=new Function(t||"_x","_",i)}catch(e){throw e.res=i,console.log(i),e}return function(e){return o.call(this,e,d)}}}),d.extend({watch:function(e,t,n){function i(){return a}function r(i){return o=a,a=n.call(e,i,o,t)}var o=e[t],a=o;return delete e[t]&&(Object.defineProperty?Object.defineProperty(e,t,{get:i,set:r,enumerable:!0,configurable:!0}):Object.prototype.__defineGetter__&&Object.prototype.__defineSetter__&&(Object.prototype.__defineGetter__.call(e,t,i),Object.prototype.__defineSetter__.call(e,t,r))),e},unwatch:function(e,t){var n=e[t];return delete e[t],e[t]=n,e}}),d.extend({addEvent:function(e,t,n){return e._events||d.define(e,"_events",{value:{},writable:!0,enumerable:!1,configurable:!0}),e._events[t]||(e._events[t]=[]),d.has(e._events[t],n)||e._events[t].push(n),e},removeEvent:function(e,t,n){if(e._events[t])d.not(e._events[t],n),e._events[t].length&&n||delete e._events[t];else if(!t&&!n)return d.release(e);return e},release:function(e){return delete e._events,e},dispatch:function(e,t,n,i){var r=d.isFunction(n);return e._events&&e._events[t]&&(r?d.foreach(e._events[t],function(t){t===n&&t.apply(e,i||[])}):d.foreach(e._events[t],function(t){t.apply(e,i||[])})),e},trigger:function(e,t,n,i){return d.dispatch(e,t,n,i)}}),d.root.self){var x=function(e){this.info=e.userAgent,this.language=e.language,this.platform=e.platform};d.extend(x.prototype,{defineBroswer:function(e,t){var n=this.info;this.browser={};for(var i=e.length;i--;)t[i].call(n,d.root)?this.browser[e[i]]=!0:this.browser[e[i]]=!1;return this},definePlatform:function(e,t){var n=this.info;this.version={};for(var i=e.length;i--;)this.version[e[i]]=t[i].call(n,d.root);return this}});var E=new x(d.root.navigator).defineBroswer(["IE","Edge","Opera","Chrome","Safari","FireFox","Mobile","Desktop"],[function(){return/(Trident|MSIE)/i.test(this)},function(){return/Edge/i.test(this)&&/Webkit/i.test(this)},function(){return/Opera/i.test(this)&&/Webkit/i.test(this)},function(e){return null!=e.chrome},function(){return/Safari/i.test(this)&&!/Chrome/i.test(this)},function(e){return/Firefox/i.test(this)&&e.netscape&&/Gecko/.test(this)},function(e){return e.devicePixelRatio>1},function(e){return null==e.devicePixelRatio||1===e.devicePixelRatio}]).definePlatform(["OS","RenderEnginner","Chrome","Firefox","IE"],[function(e){return/Windows/gi.test(this)?"Windows":/(Linux|Ubuntu|CentOS|Debian|Arach|RedHat|FreeBSD|Unix)/gi.test(this)?"Linux":/Macintosh/gi.test(this)?"Mac OS X":/iOS|iPad|iPhone/gi.test(this)?"iOS":/Android/gi.test(this)?"Android":"UnKown"},function(e){return/(Webkit|Gecko|Trident)/gi.exec(this)[0]},function(e){return!!/Chrome/gi.test(this)&&this.match(/(Chrome)\/([\d\.]+)/gi)[0].replace(/[^\d\.]/gi,"")},function(e){return!!/Firefox/gi.test(this)&&/Firefox\/([\d\.]+)/gi.exec(this)[1]},function(e){return!!/IE/gi.test(this)&&parseInt(/MSIE\ ([\d\.]+)/gi.exec(this)[1])}]),S=0,_=d.root.localStorage;_.getItem("aixcache")||_.setItem("aixcache","{}"),d.extend({cookieparse:function(e){var t,n={},i=e?e.split(";"):[];return i.forEach(function(e){t=(e||"").split("="),t.length&&(n[d.trim(t[0])]=d.trim(t[1]))}),n},cookie:function(e){var t=d.slice(arguments),n=t.length,i=d.cookieparse(d.root.document.cookie);if(n){if(1===n)return i[e];var r=new Date;return r.setDate(r.getDate()+365),d.root.document.cookie=d.trim(t[0]+"="+(t[1]||"")+";expires="+(t[2]||r.toGMTString())+";path="+(t[3]||"/")+";domain="+(t[4]||"")+";"+(t[5]?"secure":""))}return i},aix:function(e){var t=d.compose({url:"",type:"GET",param:d.broken,aysnc:!0,vaild:!0,cache:!1,success:d.NULL,fail:d.NULL,loading:null,loaded:null,header:d.broken,username:null,password:null,timeout:0},e||{});if(t.cache){var n=JSON.parse(_.getItem("aixcache")),i=t.url||d.root.location.href.split("#")[0];if(n[i])return t.success.call(d.root,n[i])}var r=new XMLHttpRequest;if("GET"===t.type.toUpperCase()&&t.param&&(t.url+=(t.url.search(/\?/g)===-1?d.keys(t.param).length?"?":"":"&")+d.paramstringify(t.param),t.param=null),d.isFunction(t.loading)){var o=function(e){t.loading.call(d.root,e)};r.addEventListener("loadstart",function(e){o(e),r.removeEventListener("loadstart",o),o=null})}if(d.isFunction(t.loaded)){var a=function(e){t.loaded.call(d.root,e)};r.addEventListener("loadend",function(e){a(e),r.removeEventListener("loadend",o),a=null})}return null!=t.username?r.open(t.type,t.url,t.aysnc,t.username,t.password||""):r.open(t.type,t.url,t.aysnc),"POST"===t.type&&t.param&&r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.setRequestHeader("Aix-Requested","AixHttpRequest"),d.isObject(t.header)&&t.header!==d.broken&&d.foreach(t.header,function(e,t){r.setRequestHeader(t,e)}),r.onreadystatechange=function(e){if(4===r.readyState&&r.responseText){var n=r.status;if(n>=200&&n<300||304===n){if(t.success.call(d.root,r.responseText,r,e),t.cache){var i=JSON.parse(_.getItem("aixcache"));i[t.url||d.root.location.href.split("#")[0]]=r.responseText,_.setItem("aixcache",JSON.stringify(i))}}else t.fail.call(d.root,r,e)}},r.send(t.param?d.isObject(t.param)?d.paramstringify(t.param):t.param:null),S++,t.timeout&&d.async(function(){r.abort(),t.fail.call(d.root,r)},1e3*t.timeout||5e3),r},aixp:function(e){var t=d.compose({url:"",param:d.broken,key:"callback",fn:("jsonp"+Math.random()).replace(".",""),timeout:5,success:d.NULL,fail:d.NULL},e||{}),n=t.url+"?"+d.paramstringify(t.param)+(d.keys(t.param).length?"&":"")+t.key+"="+t.fn,i=d.root.document.createElement("script");i.src=n,d.root[t.fn]=function(e){clearTimeout(t.timesetup),d.root.document.body.removeChild(i),d.root[t.fn]=null,t.success.call(d.root,e)},d.root.document.body.append(i),t.timeout&&(t.timesetup=setTimeout(function(){d.root.document.body.removeChild(i),d.root[t.fn]=null,t.success.call(d.root)},1e3*t.timeout)),S++},pagepref:function(){var e=d.slice(document.getElementsByTagName("*")),t="",n={},i="",r={},o="",a="",c=d.slice(document.getElementsByTagName("img")),s=[],u=d.slice(document.getElementsByTagName("script")),l=function(e,t,n){e[n]?e[n].push(t):e[n]=[t]};d.foreach(e,function(e){var c=e.getAttribute("class");c&&(i+=" "+c,c=d.trim(c).split(" "),d.foreach(c,function(t){l(r,e,t)})),c=e.getAttribute("id"),c&&(t+=" "+c,c=d.trim(c),l(n,e,c)),c=d.root.getComputedStyle(e),c&&c.backgroundImage&&"none"!==c.backgroundImage.toLowerCase()&&(a+=" "+c.backgroundImage),c=e.getAttribute("href"),c&&(o+=" "+c)}),d.foreach(c,function(e){var t=e.getAttribute("src");t&&(a+=" "+t)}),d.foreach(u,function(e){var t=e.getAttribute("src");t&&s.push(t.split("/").pop().slice(0,-3))});var f=t.split(" ");f.shift(),f=d.unique(f);var h=i.split(" ");h.shift(),h=d.unique(h);var p=a.split(" ");p.shift(),p=d.unique(p);var g=o.split(" ");return g.shift(),g=d.unique(g),{_url:window.location.href,htmlsize:(document.body.innerHTML+document.head.innerHTML).replace(v,"").length,htmltags:e.length,idlist:f.sort(),idchecker:n,classlist:h.sort(),classchecker:r,scriptlist:s,imglist:p.sort(),linklist:g.sort(),cookies:d.cookie(),localstorage:_||{},_aixxhr:S}},ua:E})}var N;d.stack=N=function(e){var t=e||[],n=[];d.foreach(t,function(e){var t=d.isObject(e)?d.toarray(e):e||[],i=d.isFunction(t[0])?t[0]:d.NULL,r=d.isNumber(t[1])?t[1]:0,o=function(e){setTimeout(function(){var t=n.pop(),r=i.call(d.root,e);t&&t.call(d.root,r)},1e3*r)};n.push(o)}),d.define(this,"=",{value:n,writable:!0,enumerable:!1,configurable:!1})},d.extend(N.prototype,{noop:function(){return this["="]=[],this},fire:function(){return this["="].length&&this["="].pop().call(d.root)},add:function(){return this.push.apply(this,d.slice(arguments))},push:function(){var e=this,t=d.slice(arguments);d.foreach(t,function(t){if(!d.isFunction(t)&&!d.isArray(t))return console.error("add/push arguments error when assign to stack!");var n=d.isArray(t)?t[0]:t,i=d.isArray(t)?t[1]||0:parseFloat(t||0),r=function(t){setTimeout(function(){var i=e["="].pop(),r=n.call(d.root,t);i&&i.call(d.root,r)},1e3*i)};e["="].push(r)})}});var O;return d.hack=O=function(e,t){var n=this,i=e||[],r=i.length,o=new Array(r),a=[];d.define(this,{complete:{value:t||d.NULL,writable:!0,enumerable:!1,configurable:!1},"-":{value:a,writable:!0,enumerable:!1,configurable:!1}}),d.foreach(i,function(e,t){var i=t,r=d.isObject(e)?d.toarray(e):e||[],c=d.isFunction(r[0])?r[0]:d.NULL,s=d.isNumber(r[1])?r[1]:0,u=function(){setTimeout(function(){var e=c();o[i]=e||1,d.has(o)||(n.complete.apply(d.root,o),n.noop())},1e3*s)};a.push(u)})},d.extend(O.prototype,{noop:function(){return this["-"]=null,this.complete=null,this},fire:function(){return this["-"].length?d.foreach(this["-"],function(e){return e.call(d.root)}):0}}),d}),function(e,t){"function"==typeof define&&define.amd?define(t):e.__=t(_)}(this,function(e){"use strict";function t(){u||(u=!0,f.forEach(function(t,n){t.fn.call(e.root,t.ct)}),f=[])}function n(e){h.length>=d.config.limit&&h.shift(),h.push(e)}function i(t){return t.$el.every(function(t){return e.ua.browser.IE?document.body.contains(t):document.contains(t)})}function r(t){t=e.trim(t);var n,i=!b.test(t),o=!y.test(t);if(i&&o){if(p.test(t))return[document.getElementById(t.substr(1))];if(v.test(t))n=document.getElementsByClassName(t.substr(1));else if(g.test(t))n=document.getElementsByTagName(t);else{if(m.test(t)){var a=m.exec(t),c=a[1],s=a[2],u=a[3];return null==c?e.slice(document.getElementsByTagName("*")).filter(function(e){return e.getAttribute(s)===u}):r(c).filter(function(e){return e.getAttribute(s)===u})}n=document.querySelectorAll(t)}}else{if(L.test(t)){var l=document.createElement("i");return l.innerHTML=t,n=e.slice(l.querySelectorAll("*")),n.filter(function(e){return 1===e.nodeType})}n=document.querySelectorAll(t)}return e.slice(n)}function o(e){if(e.search("rgb")!=-1){var t=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return"#"+c(t[1])+c(t[2])+c(t[3])}return e}function a(e){if(e.search("-")!=-1){for(var t=e.split("-"),n=1,i=t.length;n<i;n++)t[n]=t[n].charAt(0).toUpperCase()+t[n].slice(1);return t.join("")}return e}function c(e){return("0"+parseInt(e).toString(16)).slice(-2)}function s(t,n,i){var r="CustomEvent";e.foreach(E,function(t,i){e.has(t,n)&&(r=i)});var o={data:i,bubbles:!0,cancelable:!0,target:t,toElement:t,srcElement:t,currentTarget:t};switch(r){case"CustomEvent":return new CustomEvent(n,o);case"UIEvent":return new UIEvent(n,o);case"MouseEvent":return new MouseEvent(n,o);case"KeyboardEvent":return new KeyboardEvent(n,o)}}var u=!1,l=!1,f=[],h=[],d=function(n,r){if(e.isFunction(n))return u?setTimeout(function(){n(r)},0):(f.push({fn:n,ct:r}),"complete"===document.readyState?setTimeout(t,0):l||document.addEventListener("DOMContentLoaded",t,!1),void(l=!0));if(n instanceof w)return n;if(e.isString(n)){var o;if(h.forEach(function(e){e.$indicator===n&&(o=e)}),null!=o&&i(o))return e.clonedoom(o)}return new w(n)};d.config={limit:4,version:e.version};var p=/^#[^\s\=\+\.\#\[\]]+/i,v=/^\.[^\s\=\+\.\#\[\]]+$/i,g=/^[^\[\]\+\-\.#\s\=]+$/i,m=/([^\s]+)?\[([^\s]+)=["']?([^\s'"]+)["']?\]$/i,b=/[\s|\r]+/gi,y=/[>|\+|\~]+/gi,L=/<[a-z][\s\S]*>/i,w=function(t){return this.$el=[],null!=t&&(e.isString(t)?(this.$el=r(t),this.$indicator=t):t!==document&&t!==e.root&&1!==t.nodeType||(this.$el.push(t),this.$indicator="")),this.length=this.$el.length,n(e.clonedoom(this)),this};d.fn=w.prototype={constructor:w,version:e.version,extend:function(t){e.extend(d.fn,t)}},d.fn.extend({each:function(t,n){return e.foreach(this.$el,t,n)},get:function(e){return this.$el[+e+(e<0?this.length:0)]},at:function(t){var n=e.clonedoom(this);return t=+t+(t<0?n.length:0),n.$el=[n.$el[t]],n.length=1,n},first:function(){return this.at(0)},last:function(){return this.at(-1)},by:function(t){var n=e.clonedoom(this);return n.$el=n.$el.filter(t),n.length=n.$el.length,n},even:function(){return this.by(function(e,t){return t%2!=0})},odd:function(){return this.by(function(e,t){return t%2==0})},next:function(t){var n=e.clonedoom(this),i=[],r=t?"previousElementSibling":"nextElementSibling";return e.foreach(n.$el,function(e){null!=e[r]&&i.push(e[r])}),n.$el=e.filter(i,function(e){return 3!==e.nodeType&&8!==e.nodeType&&"SCRIPT"!==e.nodeName}),n.length=n.$el.length,n},prev:function(e){return this.next(!e)},find:function(t){var n=e.clonedoom(this),i=[];return e.foreach(n.$el,function(n){i=e.slice(n.querySelectorAll(t)).concat(i)}),n.$el=i,n.length=n.$el.length,n},siblings:function(){var t=e.clonedoom(this),n=[],i=t.$el;return e.foreach(t.$el,function(t){n=e.slice(t.parentNode.children).concat(n)}),t.$el=e.filter(e.unique(n),function(t){return!e.has(i,t)}),t.length=t.$el.length,t},childrens:function(){var t=e.clonedoom(this),n=[];return e.foreach(t.$el,function(t){n=e.slice(t.children).concat(n)}),t.$el=e.unique(n),t.length=t.$el.length,t}});var x=["checked","disabled","readonly","required","validate"];d.fn.extend({addClass:function(t){return this.each(function(n){var i=n.getAttribute("class");i?(i=i.split(" "),n.setAttribute("class",e.unique(i.concat(t.split(" "))).join(" "))):n.setAttribute("class",e.unique(t.split(" ")).join(" "))})},removeClass:function(t){return this.each(function(n){var i=n.getAttribute("class");i&&(i=i.split(" "),e.foreach(t.split(" "),function(t){e.not(i,t)}),n.setAttribute("class",i.join(" ")))})},toggleClass:function(t){return this.each(function(n){var i=n.getAttribute("class");i?(i=i.split(" "),e.foreach(e.unique(t.split(" ")),function(t){e.has(i,t)?e.not(i,t):i.push(t)}),n.setAttribute("class",i.join(" "))):n.setAttribute("class",t)})},attr:function(){var t=e.slice(arguments);if(t.length){if(1===t.length)return this.get(0).getAttribute(t[0]);this.each(function(n){n.setAttribute(t[0],e.parseString(t[1]))})}return this},removeAttr:function(e){return this.each(function(t){t.removeAttribute(e)})},data:function(){var t=e.slice(arguments);return t[0]?(t[0]="data-"+t[0],this.attr.apply(this,t)):this},prop:function(){var t=e.slice(arguments);return t.length?1===t.length?e[e.has(x,t[0])?"isString":"cool"](this.attr(t[0])):t[1]!==!1&&0!==t[1]?this.attr(t[0],e.has(x,t[0])?"":t[1]):this.removeAttr(t[0]):this},removeProp:function(e){return this.removeAttr(e)},value:function(t){if(e.slice(arguments).length)return this.each(function(n){var i=n.tagName.toUpperCase();"SELECT"===i?e.foreach(e.slice(n.options),function(e){e.removeAttribute("selected"),(e.getAttribute("value")||e.innerText)===t+""&&e.setAttribute("selected","")}):n.setAttribute("value",t)});var n=this.get(0);return"SELECT"===n.tagName.toUpperCase()?n.options[n.selectedIndex].value||n.innerText:n.value||n.getAttribute("value")},text:function(t){return null!=t?this.each(function(e){e.innerText=t+""}):e.decodeHTML(this.get(0).innerText||"")},fill:function(t){var n="";return null!=t?(t.nodeType&&1===t.nodeType?n=t.outerHTML:e.isObject(t)&&t instanceof w?t.each(function(e){n+=e.outerHTML}):n=t+"",this.each(function(e){e.innerHTML=n+""})):this.get(0).innerHTML||""},html:function(){return this.fill.apply(this,e.slice(arguments))},empty:function(){return this.each(function(e){e.innerHTML=""})},offset:function(){var e=0,t=0,n=0,i=0,r=this.get(0);for(n=r.offsetWidth,i=r.offsetHeight;r;)t+=r.offsetLeft,e+=r.offsetTop,r=r.offsetParent;return{top:e,left:t,witdh:n,height:i}},pos:function(){var e=this.get(0);return{top:e.offsetTop,left:e.offsetLeft,width:e.offsetWidth,height:e.offsetHeight}},draw:function(t,n){if(e.isString(t))return null==n?o(window.getComputedStyle(this.get(0),null)[t]):this.each(function(e){e.style[a(t)]=n+""});if(e.isObject(t))for(var i in t)this.draw(i,t[i]);return this},redraw:function(){return this.removeAttr("style")}});var E={UIEvent:["focus","blur","focusin","focusout"],MouseEvent:["click","dbclick","mouseup","mousedown","mouseout","mouseover","mouseenter","mouseleave"],KeyboardEvent:["keydown","keypress","keyup"]};return d.fn.extend({reg:function(t,n,i,r){return this.each(function(o){if(null==o._events&&e.define(o,"_events",{value:{},writable:!0,enumerable:!1,configurable:!0}),null!=n){var a=function(e){n.call(i||o,e,t,i)};a.fn=n.fn||n,a.cal=n,null==o._events[t]&&(o._events[t]=[]),o._events[t].push(a),o.addEventListener(t,a,!!r)}})},purge:function(t,n){return this.each(function(i){e.isString(t)?null!=n?(null!=i._events[t]?(i.removeEventListener(t,e.cat(i._events[t],function(e){return e.fn===n})[0]||n),i._events[t].length||delete i._events[t]):i.removeEventListener(t,n),null!=i._events["_"+t]&&(document.documentElement.removeEventListener(t,e.cat(i._events["_"+t],function(e){return e.fn===n})[0].cal,!0),i._events["_"+t].length||delete i._events["_"+t])):(e.foreach(i._events[t],function(e){i.removeEventListener(t,e)}),e.foreach(i._events["_"+t],function(e){document.documentElement.removeEventListener(t,e.cal,!0)}),delete i._events["_"+t],delete i._events[t]):(e.foreach(i._events,function(t,n){n.search("_")!=-1?e.foreach(t,function(e){detectLive.removeEventListener(n.slice(1),e.cal,!0)}):e.foreach(t,function(e){i.removeEventListener(n,e)})}),i._events={})})},off:function(e,t,n){return this.purge(e,n)},on:function(){return this.live.apply(this,e.slice(arguments))},agent:function(){return this.live.apply(this,e.slice(arguments))},live:function(t,n,i,r,o){var a,c=!e.isFunction(n);return e.isFunction(i)||(a=i,i=e.isFunction(r)?r:e.NULL,r=o),this.each(function(o){if(c){var s=function(c){var s=c.target||c.toElement;if(c.data=a,e.has(d(o).find(n).$el,s))return i.call(r||s,c,t)};s.fn=i,s.elm=o,d(o).reg("_"+t,s,null),document.documentElement.addEventListener(t,s,!0)}else d(o).reg(t,n,i)})},signet:function(t,n){return null!=t?null!=n?this.each(function(i){i[t]?i.name=n:e.define(i,t,{value:n,writable:!0,enumerable:!1,configurable:!0})}):this.get(0)[t]:this},once:function(e,t){return this.each(function(n){var i=function(r){t.call(n,r,e),n.removeEventListener(e,i),i=null};n.addEventListener(e,i)})},dispatch:function(t,n){return this.each(function(i){var r=s(i,t);return e.isFunction(n)?n.call(i,r):i.dispatchEvent(r)})}}),d}),function(e,t){"function"==typeof define&&define.amd?define(t):e.aix=t(_,__)}(this,function(e,t){"use strict";function n(t){return function(){var n=e.clonedoom(this.data),i=[n].concat(e.slice(arguments));return n=e[t].apply(n,i),e.isequal(n,this.data)||(this.data=n,this.dispatch(t,null,i)),this}}function i(t){return function(){var n=e.clonedoom(this.data),i=[n].concat(e.slice(arguments));return e[t].apply(n,i)}}function r(t,n,i){e.foreach(this.routes,function(e,r){RegExp(r,"i").test(t)&&o.call(this,e,[i,t,n,r])},this)}function o(t,n){switch(e.typeof(t)){case"function":t.apply(this||e.root,n);break;default:e.foreach(e.isString(t)?t.split(","):t,function(t){this.action[t].apply(this||e.root,n)},this)}}var a={},c=0,s=0,u=0,l={el:"",template:""},f={routes:{},action:{}},h={data:""},d={data:[],model:0},p={get:"GET",put:"PUT",post:"POST",pull:"PULL",fetch:"FETCH",update:"UPDATE",delete:"DELETE"},v={get:"GET",put:"POST",post:"POST",pull:"POST",fetch:"GET",update:"POST",delete:"POST"},g=v;a.aixpref=function(){return{count:{views:c,models:s,collections:u}}},a.config={restful:!1},e.watch(a.config,"restful",function(e){return g=e?p:v,e}),a.model=function(t){var n=this;e.define(n,{aid:{value:"#"+ ++s,writable:!0,enumerable:!1},change:{value:!1,writable:!0,enumerable:!1}}),e.isObject(t.events)&&e.foreach(t.events,function(t,i){e.addEvent(n,i,t)}),e.isFunction(t.validate)&&e.define(n,"validate",{value:t.validate,writable:!1,enumerable:!1,configurable:!1}),delete t.validate,delete t.change,delete t.events,e.extend(n,e.extend(e.clone(h),t)),e.watch(n,"data",function(t,i){if(e.isFunction(n.validate)){var r=!0;return(e.isFunction(n.validate)?!n.validate.call(n,t):0)&&(r=!1),r?(e.isequal(t,i)||(e.dispatch(n,"change",null,[t,i]),n.change=!0),e.dispatch(n,"validate",null,[t,i]),e.dispatch(n,"validate:success",null,[t,i]),t):(e.dispatch(n,"validate",null,[t,i]),e.dispatch(n,"validate:fail",null,[t,i]),i)}return e.isequal(t,i)||(e.dispatch(n,"change",null,[t,i]),n.change=!0),t}),e.dispatch(n,"init")},a.model.extend=function(t){var n=function(n){var i=this,r=e.extend(e.clone(h),t),o=e.extend(r,n);e.isObject(o.events)&&e.foreach(o.events,function(t,n){e.addEvent(i,n,t)}),e.isFunction(o.validate)&&e.define(i,"validate",{value:o.validate,writable:!1,enumerable:!1,configurable:!1}),delete o.validate,delete o.change,delete o.events,e.compose(i,o),i.data=e.clone(this.data),e.define(i,{aid:{value:"#"+ ++s,writable:!0,enumerable:!1},change:{value:!1,writable:!0,enumerable:!1}}),e.watch(i,"data",function(t,n){if(e.isFunction(i.validate)){var r=!0;return(e.isFunction(i.validate)?!i.validate.call(i,t):0)&&(r=!1),r?(e.isequal(t,n)||(e.dispatch(i,"change",null,[t,n]),i.change=!0),e.dispatch(i,"validate",null,[t,n]),e.dispatch(i,"validate:success",null,[t,n]),t):(e.dispatch(i,"validate",null,[t,n]),e.dispatch(i,"validate:fail",null,[t,n]),n)}return e.isequal(t,n)||(e.dispatch(i,"change",null,[t,n]),i.change=!0),t}),e.dispatch(i,"init")};return e.compose(n.prototype,a.model.prototype),n.prototype.constructor=n,e.define(n,"base",{value:a.model,writable:!1,enumerable:!1,configurable:!1}),n},a.model.prototype={constructor:a.model,get:function(t){return e.isString(t)?e.clone(this.data[t]||""):e.clone(this.data)},set:function(){var t=e.slice(arguments);return t.length>1?this.data[t[0]]=t[1]:this.data=t[0],this},addEvent:function(t,n){return e.isFunction(n)&&e.addEvent(this,t,n),this},removeEvent:function(t,n){return e.removeEvent(this,t,n)},dispatch:function(t,n,i){return e.dispatch(this,t,e.isFunction(n)?n:null,i)},trigger:function(e,t,n){return this.dispatch(e,t,n)},listen:function(t,n){return e.isObject(this.data)&&e.watch(this.data,t,n),this},unlisten:function(t){return e.isObject(this.data)&&e.unwatch(this.data,t),this},add:function(){var t=e.slice(arguments),n=e.clonedoom(this.data),i=e.typeof(n);return e.foreach(t,function(t){switch(i){case"number":n+=e.isNumber(+t)?+t:0;break;case"string":n+=t.toString();break;case"array":n=n.concat(t);break;case"object":e.isObject(t)&&e.extend(n,t)}}),this.data=n,this.dispatch("add",null,t)},rev:function(){var t=e.slice(arguments),n=e.clonedoom(this.data),i=e.typeof(n);return e.foreach(t,function(t){switch(i){case"array":e.isArray(t)?e.foreach(t,function(t){e.not(n,t)}):e.not(n,t);break;case"object":e.isArray(t)?e.foreach(t,function(e){delete n[e]}):delete n[t]}}),this.data=n,this.dispatch("remove",null,t)}},a.collection=function(t){var n=this;e.define(n,{cid:{value:"#"+ ++u,writable:!0,enumerable:!1},change:{value:!1,writable:!0,enumerable:!1}}),e.isObject(t.events)&&e.foreach(t.events,function(t,i){e.addEvent(n,i,t)}),e.isFunction(t.validate)&&e.define(n,"validate",{value:t.validate,writable:!1,enumerable:!1,configurable:!1}),delete t.validate,delete t.change,delete t.events,e.extend(n,e.extend(e.clone(d),t)),n.model&&(n.data=e.filter(n.data,function(e){return e.constructor===n.model})),e.watch(n,"data",function(t,i){if(e.isArray(t)||(t=[t]),e.isFunction(n.validate)){var r=!0;return e.foreach(t,function(t){(n.model?t.constructor!==n.model:0)&&(r=!1),(e.isFunction(n.validate)?!n.validate.call(n,t):0)&&(r=!1)}),r?(e.isequal(t,i)||(e.dispatch(n,"change",null,[t,i]),n.change=!0),e.dispatch(n,"validate",null,[t,i]),e.dispatch(n,"validate:success",null,[t,i]),t):(e.dispatch(n,"validate",null,[t,i]),e.dispatch(n,"validate:fail",null,[t,i]),i)}return e.isequal(t,i)||(e.dispatch(n,"change",null,[t,i]),n.change=!0),t}),e.dispatch(n,"init")},a.collection.extend=function(t){var n=function(n){var i=this,r=e.extend(e.clone(d),t),o=e.extend(r,n);e.isObject(o.events)&&e.foreach(o.events,function(t,n){e.addEvent(i,n,t)}),e.isFunction(o.validate)&&e.define(i,"validate",{value:o.validate,writable:!1,enumerable:!1,configurable:!1}),delete o.validate,delete o.change,delete o.events,e.compose(i,o),e.define(i,{aid:{value:"#"+ ++u,writable:!0,enumerable:!1},change:{value:!1,writable:!0,enumerable:!1}}),e.watch(i,"data",function(t,n){if(e.isArray(t)||(t=[t]),e.isFunction(i.validate)){var r=!0;return e.foreach(t,function(t){(i.model?t.constructor!==i.model:0)&&(r=!1),(e.isFunction(i.validate)?!i.validate.call(i,t):0)&&(r=!1)}),r?(e.isequal(t,n)||(e.dispatch(i,"change",null,[t,n]),i.change=!0),e.dispatch(i,"validate",null,[t,n]),e.dispatch(i,"validate:success",null,[t,n]),t):(e.dispatch(i,"validate",null,[t,n]),e.dispatch(i,"validate:fail",null,[t,n]),n)}return e.isequal(t,n)||(e.dispatch(i,"change",null,[t,n]),i.change=!0),t}),e.dispatch(i,"init")};return e.compose(n.prototype,a.collection.prototype),n.prototype.constructor=n,e.define(n,"base",{value:a.collection,writable:!1,enumerable:!1,configurable:!1}),n},a.collection.prototype={constructor:a.collection,addEvent:function(t,n){return e.isFunction(n)&&e.addEvent(this,t,n),this},removeEvent:function(t,n){
return e.removeEvent(this,t,n)},listen:function(t,n){return e.isObject(this.data)&&e.watch(this.data,t,n),this},unlisten:function(t){return e.isObject(this.data)&&e.unwatch(this.data,t),this},add:function(){var t=this.data.length,n=e.slice(arguments),i=e.slice(this.data);return n.length&&(i=i.concat.apply(i,n)),e.isequal(this.data,i)?this:(this.data=i,this.data.length===t?this:this.dispatch("add",null,n))},rev:function(t){var n,i=this.data.length;return e.isString(t)?(n=e.slice(this.data),n=e.cat(n,function(e){return e.aid!=="#"+t})):e.isObject(t)&&(e.isFunction(this.model)?t instanceof this.model&&(n=e.slice(this.data),n=e.not(n,t)):(n=e.slice(this.data),n=e.not(n,t))),n?(this.data=n,this.data.length===i?this:this.dispatch("remove",null,[t])):this},get:function(t){return e.isString(t)?e.filter(this.data,function(e){return e.aid==="#"+t}):e.slice(this.data)},set:function(t){return this.data=e.isArray(t)?t:[t],this},dispatch:function(t,n,i){return e.dispatch(this,t,e.isFunction(n)?n:null,i)},trigger:function(e,t,n){return this.dispatch(e,t,n)}},e.foreach(["foreach","splice","sort","unique","reject","filter","map","find","cat","groupby","toarray","forarray","pairs","not","bale","pluck","reverse","shuffle","merge"],function(e){a.model.prototype[e]=n(e),a.collection.prototype[e]=n(e)}),e.foreach(["keys","clone","contain","has","isequal","requery","typeof"],function(e){a.model.prototype[e]=i(e),a.collection.prototype[e]=i(e)}),e.extend(a.model.prototype,{toJSON:function(){return e.isArray(this.data)||e.isObject(this.data)?JSON.stringify(this.data):this.data},parse:function(){return e.isString(this.data)?JSON.parse(this.data):e.clone(this.data)},pipe:function(t,n,i,r,o){var a,c,s=this,u={type:g[t.toLowerCase()],aysnc:!0},l=e.isFunction(i);e.isString(n)?(u.url=n,u.param=l?{}:i||{},a=l?i:r||e.NULL,c=l?r||e.NULL:o||e.NULL):e.isObject(n)?(u.url=s.url||"/",u.param=l?n:i||{},a=l?i:r||e.NULL,c=l?r||e.NULL:o||e.NULL):(u.url=s.url||"/",a=e.NULL,c=e.NULL),u.success=function(e,n,i){a.call(s,e,n,i),s.dispatch(t+":success",null,[e,n,i])},u.fail=function(e,n){c.call(s,e,n),s.dispatch(t+":fail",null,[e,n])};var f=e.aix(u);return this.dispatch(t,null,[f])},aget:function(t,n,i,r){return i=e.isFunction(i)?i:e.NULL,r=e.isFunction(r)?r:e.NULL,this.pipe.apply(this,["get",t||this.url||"",n,i,r])},fetch:function(t,n,i){return n=e.isFunction(n)?n:e.NULL,i=e.isFunction(i)?i:e.NULL,this.pipe.apply(this,["fetch",this.url||"",t,function(e,t,i){this.data=JSON.parse(e),n.call(this,e,t,i)},i])},pull:function(){return this.fetch.apply(this,e.slice(arguments))},post:function(t,n,i,r){return i=e.isFunction(i)?i:e.NULL,r=e.isFunction(r)?r:e.NULL,this.pipe.apply(this,["post",t||this.url||"",n||this.parse(),i,r])}}),e.extend(a.collection.prototype,{toJSON:function(){var t=[];return e.foreach(this.data,function(e){t.push(e.get?e.get():e)}),JSON.stringify(t)},parse:function(){return JSON.parse(this.toJSON())},pipe:function(t,n,i,r,o){var a,c,s=this,u={type:g[t.toLowerCase()],aysnc:!0},l=e.isFunction(i);e.isString(n)?(u.url=n,u.param=l?{}:i||{},a=l?i:r||e.NULL,c=l?r||e.NULL:o||e.NULL):e.isObject(n)?(u.url=s.url||"/",u.param=l?n:i||{},a=l?i:r||e.NULL,c=l?r||e.NULL:o||e.NULL):(u.url=s.url||"/",a=e.NULL,c=e.NULL),u.success=function(e,n,i){a.call(s,e,n,i),s.dispatch(t+":success",null,[e,n,i])},u.fail=function(e,n){c.call(s,e,n),s.dispatch(t+":fail",null,[e,n])};var f=e.aix(u);return this.dispatch(t,null,[f])},aget:function(t,n,i,r){return i=e.isFunction(i)?i:e.NULL,r=e.isFunction(r)?r:e.NULL,this.pipe.apply(this,["get",t||this.url||"",n,i,r])},fetch:function(t,n,i){return n=e.isFunction(n)?n:e.NULL,i=e.isFunction(i)?i:e.NULL,this.pipe.apply(this,["fetch",this.url||"",t,function(t,i,r){var o=this;o.data=JSON.parse(t),o.model&&e.foreach(data,function(e,t){data[t]=new o.model({data:e})}),o.data=data,n.call(this,t,i,r)},i])},pull:function(){return this.fetch.apply(this,e.slice(arguments))},post:function(t,n,i,r){return i=e.isFunction(i)?i:e.NULL,r=e.isFunction(r)?r:e.NULL,this.pipe.apply(this,["post",t||this.url||"",n||this.parse(),i,r])}}),t=t||e.NULL,a.view=function(n){if(n=n||{},!e.isString(n.el))return console.error("view must define its 'el' prop bind with elm (custom string)");var i=this;return e.define(i,{vid:{value:"#"+ ++c,writable:!0,enumerable:!1}}),e.isObject(n.events)&&e.foreach(n.events,function(r,o){var a=o.split(":");a.length>1?t(n.el).on(a[0],a[1],{self:i},r):e.addEvent(i,o,r)}),n.template&&!e.isString(n.template)||(n.template=e.isFunction(n.build)?n.build.call(i,n.template||""):e.doom(n.template||"")),n.render&&e.isFunction(n.render)||(n.render=function(e){return t(this.el).html(this.template(e))&&this}),delete n.change,delete n.events,e.isString(n.url)?(e.aix({url:n.url,cache:!e.isBoolean(n.cache)||n.cache,success:function(t){n.template=e.isFunction(n.build)?n.build.call(i,t):e.doom(t),e.extend(i,e.extend(e.clone(l),n)),e.dispatch(i,"init")},fail:function(e){console.error("Fetch template url->["+n.url+"] has fail!"),console.log(e)}}),this):(e.extend(i,e.extend(e.clone(l),n)),void e.dispatch(i,"init"))},a.view.prototype={addEvent:function(n,i){var r=n.split(":");return r.length>1?t(this.el).on(r[0],r[1],{self:this},i):e.addEvent(this,n,i),this},removeEvent:function(n,i){var r=n.split(":");r.length>1?t(this.el).off(r[0],r[1],i):e.removeEvent(this,n,i)},dispatch:function(t,n,i){return e.dispatch(this,t,e.isFunction(n)?n:null,i)}},a.view.extend=function(n){var i=function(i){if(n=n||{},!e.isString(n.el))return console.error("view must define its 'el' prop bind with dom elm");var r=this,o=e.extend(e.clone(l),n),a=e.extend(o,i);return e.define(r,{vid:{value:"#"+ ++c,writable:!0,enumerable:!1}}),e.isObject(a.events)&&e.foreach(a.events,function(n,i){var o=i.split(":");o.length>1?t(a.el).on(o[0],o[1],{self:r},n):e.addEvent(r,i,n)}),a.template&&!e.isString(a.template)||(a.template=e.isFunction(a.build)?a.build.call(r,a.template||""):e.doom(a.template||"")),a.render&&e.isFunction(a.render)||(a.render=function(e){return t(this.el).html(this.template(e))&&this}),delete a.change,delete a.events,e.isString(a.url)?(e.aix({url:a.url,cache:!e.isBoolean(a.cache)||a.cache,success:function(t){a.template=e.isFunction(a.build)?a.build.call(r,t):e.doom(t),e.extend(r,e.extend(e.clone(l),a)),e.dispatch(r,"init")},fail:function(e){console.error("Fetch template url->[ "+a.url+" ] has fail!"),console.log(e)}}),this):(e.extend(r,e.extend(e.clone(l),a)),void e.dispatch(r,"init"))};return e.compose(i.prototype,a.view.prototype),i.prototype.constructor=i,e.define(i,"base",{value:a.view,writable:!1,enumerable:!1,configurable:!1}),i};var m=a.getHash=function(e){var t=e.search("#");return t>0?e.slice(t+1):""};return a.route=function(t){t=t||{};var n=this;this.storage=e.root.localStorage||{},e.isObject(t.events)&&e.foreach(t.events,function(t,i){e.addEvent(n,i,t)}),delete t.events,e.extend(n,e.extend(e.clone(f),t)),e.addEvent(n,"hashchange",r),e.define(this,{history:{value:{old:"",now:""},writable:!0,enumerable:!1},rid:{value:"ai-route-"+Math.random(),writable:!1,enumerable:!1,configurable:!1},event:{value:function(t){return t.newURL===t.oldURL?t.preventDefault():(n.history.now=t.newURL,n.history.old=t.oldURL,void e.dispatch(n,"hashchange",null,[m(t.newURL),m(t.oldURL),t]))},writable:!1,enumerable:!1,configurable:!1}}),e.dispatch(n,"init")},a.route.prototype={constructor:a.route,dispatch:function(t,n,i){return e.dispatch(this,t,n,i)},listen:function(){return this.$listen||(e.define(this,"$listen",{value:1,writable:!1,enumerable:!1,configurable:!0}),e.root.addEventListener("hashchange",this.event),this.dispatch("listen"),this.dispatch("hashchange",null,[m(window.location.href)])),this},stop:function(){return delete this.$listen&&(e.root.removeEventListener("hashchange",this.event),this.dispatch("stop")),this},assign:function(t){if(this.$listen){var n=e.root.location.href,i=n.search("#");i>0&&(n=n.slice(0,i)),e.root.location.href=n+("#"===t.slice(0,1)?"":"#")+t}return this},addhash:function(t){var n=e.root.location.href+(t||"");return n!==e.root.location.href&&(e.root.location.href=n),this},save:function(){return this.storage.setItem(this.rid,JSON.stringify(this.history)),this}},a});